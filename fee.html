<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Payment - School Fee Management System</title>
  <link rel="stylesheet" href="SFM.css">
  <style>
    #feeModal { display: none; }
    .footer-controls {
      background: #ecf0f1;
      padding: 8px 20px;
      display: flex;
      justify-content: center;
      align-items: center;
      position: relative;
    }
    .footer-school-name {
      font-size: 18px;
      font-weight: bold;
      color: #2c3e50;
      text-align: center;
    }
    body { background: #f9f9f9; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; }
    .main-content { max-width: 1200px; margin: 40px auto; background: #fff; border-radius: 8px; box-shadow: 0 0 10px rgba(0,0,0,0.05); padding: 48px; }
    h2 { color: #34495e; margin-bottom: 24px; }
    table { width: 100%; border-collapse: collapse; margin-bottom: 24px; }
    th, td { padding: 10px; border-bottom: 1px solid #eee; text-align: left; }
    th { background: #ecf0f1; }
    .add-btn { background: #34495e; color: #fff; border: none; padding: 8px 16px; border-radius: 4px; cursor: pointer; }
    .add-btn:hover { background: #2c3e50; }
    .topnav {
      display: flex;
      flex-direction: row;
      justify-content: center;
      background-color: #34495e;
      padding: 0;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
      position: sticky;
      top: 0;
      z-index: 10;
    }
    .topnav button {
      background: none;
      border: none;
      color: white;
      padding: 14px 28px;
      font-size: 16px;
      cursor: pointer;
      transition: background 0.3s, color 0.3s;
      outline: none;
      border-radius: 0;
    }
    .topnav button:hover, .topnav button.active {
      background-color: #2c3e50;
      color: #ffd700;
    }
    .modal-content h3 { margin-bottom: 18px; color: #34495e; }
    .modal-content label { display: block; margin: 10px 0 4px; }
    .modal-content input, .modal-content select {
      width: 100%; padding: 7px; margin-bottom: 12px; border: 1px solid #ccc; border-radius: 4px;
    }
    .modal-actions { display: flex; justify-content: flex-end; gap: 10px; }
    .modal-actions button { padding: 7px 16px; border-radius: 4px; border: none; cursor: pointer; }
    .modal-actions .save-btn { background: #34495e; color: #fff; }
    .modal-actions .cancel-btn { background: #eee; color: #34495e; }
  </style>
</head>
<body>
  <nav class="topnav">
    <button onclick="location.href='SFM.html'">Home</button>
    <button onclick="location.href='students.html'">Students</button>
    <button onclick="location.href='staff.html'">Staff</button>
    <button onclick="location.href='classes.html'">Classes</button>
    <button onclick="location.href='bus.html'">Bus</button>
    <button class="active">Payment</button>
  </nav>
  <div class="main-content">
    <div style="display: flex; align-items: center; gap: 16px; margin-bottom: 0;">
      <h2 style="margin: 0;">Payment</h2>
      <button class="add-btn" id="studentFeeTab" style="background:#34495e;color:#fff;">Student Fee</button>
      <button class="add-btn" id="payrollTab" style="background:#eee;color:#34495e;">Payroll</button>
    </div>
    <div id="addBtnRow" style="display: flex; justify-content: flex-end; align-items: center; margin-bottom: 16px; gap: 10px;">
      <button class="add-btn" id="addStudentFeeBtn">+ Add Student Fee</button>
      <button class="add-btn" id="addPayrollBtn" style="display:none;">+ Add Payroll</button>
    </div>
    <div style="margin-bottom: 16px; display: flex; align-items: center; gap: 10px;">
      <input type="text" id="searchInput" placeholder="Search by name, class, or status..." style="padding: 7px 12px; border: 1px solid #ccc; border-radius: 4px; width: 260px;">
    </div>
    <table id="studentFeeTable">
      <tr><th>Student</th><th>Class</th><th>Amount</th><th>Status</th><th>Actions</th></tr>
      <tr><td>Akash Kumar</td><td>10A</td><td>₹5000</td><td>Paid</td><td></td></tr>
      <tr><td>Priya Singh</td><td>9B</td><td>₹4800</td><td>Unpaid</td><td></td></tr>
    </table>
    <table id="payrollTable" style="display:none;">
      <tr><th>Staff</th><th>Role</th><th>Amount</th><th>Status</th><th>Actions</th></tr>
      <tr><td>Ravi Nair</td><td>Principal</td><td>₹25000</td><td>Paid</td><td></td></tr>
      <tr><td>Meera Das</td><td>Teacher</td><td>₹18000</td><td>Unpaid</td><td></td></tr>
    </table>
    <!-- Modal for adding student fee record -->
    <div class="modal" id="studentFeeModal" style="display:none;">
      <div class="modal-content">
        <h3>Add Student Fee Details</h3>
        <form id="studentFeeForm">
          <label for="student">Student</label>
          <input type="text" id="student" name="student" required>
          <label for="class">Class</label>
          <input type="text" id="class" name="class" required>
          <label for="amount">Amount</label>
          <input type="number" id="amount" name="amount" required>
          <label for="status">Status</label>
          <select id="status" name="status" required>
            <option value="Paid">Paid</option>
            <option value="Unpaid">Unpaid</option>
          </select>
          <div class="modal-actions">
            <button type="button" class="cancel-btn" id="cancelStudentFeeModal">Cancel</button>
            <button type="submit" class="save-btn">Save</button>
          </div>
        </form>
      </div>
    </div>

    <!-- Modal for adding payroll record -->
    <div class="modal" id="payrollModal" style="display:none;">
      <div class="modal-content">
        <h3>Add Payroll</h3>
        <form id="payrollForm">
          <label for="staff">Staff</label>
          <input type="text" id="staff" name="staff" required>
          <label for="role">Role</label>
          <input type="text" id="role" name="role" required>
          <label for="amount">Amount</label>
          <input type="number" id="payAmount" name="amount" required>
          <label for="payStatus">Status</label>
          <select id="payStatus" name="status" required>
            <option value="Paid">Paid</option>
            <option value="Unpaid">Unpaid</option>
          </select>
          <div class="modal-actions">
            <button type="button" class="cancel-btn" id="cancelPayrollModal">Cancel</button>
            <button type="submit" class="save-btn">Save</button>
          </div>
        </form>
      </div>
    </div>

<script>
// Tab and search logic
const studentFeeTab = document.getElementById('studentFeeTab');
const payrollTab = document.getElementById('payrollTab');
const studentFeeTable = document.getElementById('studentFeeTable');
const payrollTable = document.getElementById('payrollTable');
const addStudentFeeBtn = document.getElementById('addStudentFeeBtn');
const addPayrollBtn = document.getElementById('addPayrollBtn');

studentFeeTab.onclick = function() {
  studentFeeTab.style.background = '#34495e';
  studentFeeTab.style.color = '#fff';
  payrollTab.style.background = '#eee';
  payrollTab.style.color = '#34495e';
  studentFeeTable.style.display = '';
  payrollTable.style.display = 'none';
  addStudentFeeBtn.style.display = '';
  addPayrollBtn.style.display = 'none';
};
payrollTab.onclick = function() {
  payrollTab.style.background = '#34495e';
  payrollTab.style.color = '#fff';
  studentFeeTab.style.background = '#eee';
  studentFeeTab.style.color = '#34495e';
  studentFeeTable.style.display = 'none';
  payrollTable.style.display = '';
  addStudentFeeBtn.style.display = 'none';
  addPayrollBtn.style.display = '';
};
// Default to student fee tab
studentFeeTab.onclick();

// Search/filter logic for both tables
const searchInput = document.getElementById('searchInput');
searchInput.addEventListener('input', function() {
  const filter = this.value.trim().toLowerCase();
  // Student Fee Table
  Array.from(studentFeeTable.rows).forEach((row, i) => {
    if (i === 0) return;
    const student = row.cells[0]?.innerText.toLowerCase() || '';
    const classVal = row.cells[1]?.innerText.toLowerCase() || '';
    const status = row.cells[3]?.innerText.toLowerCase() || '';
    if (
      student.includes(filter) ||
      classVal.includes(filter) ||
      status.includes(filter)
    ) {
      row.style.display = '';
    } else {
      row.style.display = 'none';
    }
  });
  // Payroll Table
  Array.from(payrollTable.rows).forEach((row, i) => {
    if (i === 0) return;
    const staff = row.cells[0]?.innerText.toLowerCase() || '';
    const role = row.cells[1]?.innerText.toLowerCase() || '';
    const status = row.cells[3]?.innerText.toLowerCase() || '';
    if (
      staff.includes(filter) ||
      role.includes(filter) ||
      status.includes(filter)
    ) {
      row.style.display = '';
    } else {
      row.style.display = 'none';
    }
  });
});




// Modal logic for student fee (static modal in layout)
const studentFeeModal = document.getElementById('studentFeeModal');
const studentFeeForm = document.getElementById('studentFeeForm');
const cancelStudentFeeModal = document.getElementById('cancelStudentFeeModal');
addStudentFeeBtn.onclick = (e) => {
  if (studentFeeTable.style.display !== 'none') {
    studentFeeForm.reset();
    studentFeeModal.style.display = 'flex';
    addStudentFeeBtn.style.display = 'none';
    studentFeeForm.onsubmit = function(ev) {
      ev.preventDefault();
      const student = studentFeeForm.student.value.trim();
      const classVal = studentFeeForm.class.value.trim();
      const amount = studentFeeForm.amount.value.trim();
      const status = studentFeeForm.status.value;
      if (!student || !classVal || !amount || !status) return;
      const row = studentFeeTable.insertRow(-1);
      row.insertCell(0).innerText = student;
      row.insertCell(1).innerText = classVal;
      row.insertCell(2).innerText = `₹${amount}`;
      row.insertCell(3).innerText = status;
      row.insertCell(4);
      addStudentFeeActionListeners(row);
      studentFeeForm.reset();
      studentFeeModal.style.display = 'none';
      addStudentFeeBtn.style.display = '';
    };
  }
};
cancelStudentFeeModal.onclick = () => {
  studentFeeModal.style.display = 'none';
  addStudentFeeBtn.style.display = '';
};
window.addEventListener('click', function(e) {
  if (e.target === studentFeeModal) {
    studentFeeModal.style.display = 'none';
    addStudentFeeBtn.style.display = '';
  }
});
window.onclick = (e) => {
  if (e.target === studentFeeModal) {
    studentFeeModal.style.display = 'none';
    addStudentFeeBtn.style.display = '';
  }
  if (e.target === payrollModal) {
    payrollModal.style.display = 'none';
    addPayrollBtn.style.display = '';
  }
};

function addStudentFeeActionListeners(row) {
  const actionsCell = row.children[4];
  actionsCell.innerHTML = '<button class="edit-btn">Edit</button> <button class="delete-btn">Delete</button>';
  const editBtn = actionsCell.querySelector('.edit-btn');
  const deleteBtn = actionsCell.querySelector('.delete-btn');
  editBtn.onclick = function() {
    const cells = row.children;
    studentFeeForm.student.value = cells[0].innerText;
    studentFeeForm.class.value = cells[1].innerText;
    studentFeeForm.amount.value = cells[2].innerText.replace('₹','');
    studentFeeForm.status.value = cells[3].innerText;
    studentFeeModal.style.display = 'flex';
    addStudentFeeBtn.style.display = 'none';
    studentFeeForm.onsubmit = function(e) {
      e.preventDefault();
      cells[0].innerText = studentFeeForm.student.value.trim();
      cells[1].innerText = studentFeeForm.class.value.trim();
      cells[2].innerText = `₹${studentFeeForm.amount.value.trim()}`;
      cells[3].innerText = studentFeeForm.status.value;
      studentFeeModal.style.display = 'none';
      addStudentFeeBtn.style.display = '';
      studentFeeForm.reset();
      studentFeeForm.onsubmit = null;
    };
  };
  deleteBtn.onclick = function() {
    row.remove();
  };
}

function defaultStudentFeeSubmit(e) {
  e.preventDefault();
  const student = studentFeeForm.student.value.trim();
  const classVal = studentFeeForm.class.value.trim();
  const amount = studentFeeForm.amount.value.trim();
  const status = studentFeeForm.status.value;
  if (!student || !classVal || !amount || !status) return;
  const row = studentFeeTable.insertRow(-1);
  row.insertCell(0).innerText = student;
  row.insertCell(1).innerText = classVal;
  row.insertCell(2).innerText = `₹${amount}`;
  row.insertCell(3).innerText = status;
  row.insertCell(4);
  addStudentFeeActionListeners(row);
  studentFeeForm.reset();
  studentFeeModal.style.display = 'none';
}


// Modal logic for payroll (static modal in layout)
const payrollModal = document.getElementById('payrollModal');
const payrollForm = document.getElementById('payrollForm');
const cancelPayrollModal = document.getElementById('cancelPayrollModal');
addPayrollBtn.onclick = (e) => {
  if (payrollTable.style.display !== 'none') {
    payrollForm.reset();
    payrollModal.style.display = 'flex';
    addPayrollBtn.style.display = 'none';
    payrollForm.onsubmit = function(ev) {
      ev.preventDefault();
      const staff = payrollForm.staff.value.trim();
      const role = payrollForm.role.value.trim();
      const amount = payrollForm.payAmount.value.trim();
      const status = payrollForm.payStatus.value;
      if (!staff || !role || !amount || !status) return;
      const row = payrollTable.insertRow(-1);
      row.insertCell(0).innerText = staff;
      row.insertCell(1).innerText = role;
      row.insertCell(2).innerText = `₹${amount}`;
      row.insertCell(3).innerText = status;
      row.insertCell(4);
      addPayrollActionListeners(row);
      payrollForm.reset();
      payrollModal.style.display = 'none';
      addPayrollBtn.style.display = '';
    };
  }
};
cancelPayrollModal.onclick = () => {
  payrollModal.style.display = 'none';
  addPayrollBtn.style.display = '';
};
window.addEventListener('click', function(e) {
  if (e.target === payrollModal) {
    payrollModal.style.display = 'none';
    addPayrollBtn.style.display = '';
  }
});

function addPayrollActionListeners(row) {
  const actionsCell = row.children[4];
  actionsCell.innerHTML = '<button class="edit-btn">Edit</button> <button class="delete-btn">Delete</button>';
  const editBtn = actionsCell.querySelector('.edit-btn');
  const deleteBtn = actionsCell.querySelector('.delete-btn');
  editBtn.onclick = function() {
    const cells = row.children;
    payrollForm.staff.value = cells[0].innerText;
    payrollForm.role.value = cells[1].innerText;
    payrollForm.payAmount.value = cells[2].innerText.replace('₹','');
    payrollForm.payStatus.value = cells[3].innerText;
    payrollModal.style.display = 'flex';
    addPayrollBtn.style.display = 'none';
    payrollForm.onsubmit = function(e) {
      e.preventDefault();
      cells[0].innerText = payrollForm.staff.value.trim();
      cells[1].innerText = payrollForm.role.value.trim();
      cells[2].innerText = `₹${payrollForm.payAmount.value.trim()}`;
      cells[3].innerText = payrollForm.payStatus.value;
      payrollModal.style.display = 'none';
      addPayrollBtn.style.display = '';
      payrollForm.reset();
      payrollForm.onsubmit = null;
    };
  };
  deleteBtn.onclick = function() {
    row.remove();
  };
}

function defaultPayrollSubmit(e) {
  e.preventDefault();
  const staff = payrollForm.staff.value.trim();
  const role = payrollForm.role.value.trim();
  const amount = payrollForm.payAmount.value.trim();
  const status = payrollForm.payStatus.value;
  if (!staff || !role || !amount || !status) return;
  const row = payrollTable.insertRow(-1);
  row.insertCell(0).innerText = staff;
  row.insertCell(1).innerText = role;
  row.insertCell(2).innerText = `₹${amount}`;
  row.insertCell(3).innerText = status;
  row.insertCell(4);
  addPayrollActionListeners(row);
  payrollForm.reset();
  payrollModal.style.display = 'none';
}

// Add listeners to initial table rows
Array.from(studentFeeTable.rows).forEach((tr, i) => {
  if (i === 0) return;
  addStudentFeeActionListeners(tr);
});
Array.from(payrollTable.rows).forEach((tr, i) => {
  if (i === 0) return;
  addPayrollActionListeners(tr);
});
</script>
</script>
</body>
</html>
